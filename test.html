<!doctype html>
<html lang="ja">
<head>
  <meta charset="UTF-8">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <title>GAS 接続テスト</title>
</head>
<body>

<h1>GitHub → GAS テスト</h1>

<div id="out"></div>

<script>
(async () => {
  // ★ここだけ：あなたのGASの /exec を入れる（末尾は必ず小文字の exec）
  const GAS_EXEC = "https://script.google.com/macros/s/AKfycbzd5Vge6C_jaNrYV0ZegeQuhXPSQNr27sb4NtmfTDvocJ8T7qmBqE43YKsNBXQ8Dj2mEg/exec";

  // calc を GET で呼ぶ（CORS回避）
  const params = new URLSearchParams({
    action: "calc",
    distanceKm: "10",
    minutes: "30",

    // キャッシュ回避（GitHub Pages更新直後に効く）
    _ts: String(Date.now())
  });

  const url = `${GAS_EXEC}?${params.toString()}`;

  const out = document.getElementById("out");
  const add = (title, obj) => {
    const pre = document.createElement("pre");
    pre.textContent = `${title}\n` + JSON.stringify(obj, null, 2);
    out.appendChild(pre);
  };

  try {
    add("REQUEST URL:", { url });

    const r = await fetch(url, {
      method: "GET",
      // mode: "cors" はデフォルトだが明示してもOK
      mode: "cors"
    });

    // HTTPエラー表示
    if (!r.ok) {
      const text = await r.text().catch(() => "");
      add("HTTP ERROR:", { status: r.status, statusText: r.statusText, body: text });
      return;
    }

    // JSONパース
    const data = await r.json();
    add("RESPONSE JSON:", data);

  } catch (err) {
    add("FETCH ERROR:", { message: String(err), stack: err && err.stack ? String(err.stack) : null });
  }
})();
</script>

</body>
</html>
